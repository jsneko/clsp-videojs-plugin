!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({"./dist/Router.min.js":function(e,t,n){(function(e){var n,o,r,i,s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window,i=function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==("undefined"===typeof e?"undefined":s(e))&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";n.r(t),t.default=function(){return{clspRouter:function(){var e=window.parent.videojs.getPlugin("clsp").conduits.getById(window.MqttClientId).iov;function t(t){t.clientId=e.id,window.parent.postMessage(t,"*")}function n(e){var n=e.data;try{if("subscribe"===n.method)window.MQTTClient.subscribe(n.topic);else if("unsubscribe"===n.method)window.MQTTClient.unsubscribe(n.topic);else if("publish"===n.method){var o=null;try{o=JSON.stringify(n.data)}catch(e){return void console.error("json stringify error: "+n.data)}var r=new window.parent.Paho.Message(o);r.destinationName=n.topic,window.MQTTClient.send(r)}}catch(e){t({event:"fail",reason:"network failure"});try{window.MQTTClient.disconnect()}catch(e){console.error(e)}}}function o(){window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent&&window.attachEvent("onmessage",n),t({event:"ready"}),-1!==s&&(clearInterval(s),s=-1)}function r(e){t({event:"fail",reason:"Error code "+parseInt(e.errorCode)+": "+e.errorMessage})}function i(){var n={timeout:120,onSuccess:o,onFailure:r},i=new window.parent.Paho.Message(JSON.stringify({clientId:e.id}));i.destinationName="iov/clientDisconnect",n.willMessage=i,!0===e.config.useSSL&&(n.useSSL=!0);try{window.MQTTClient.connect(n)}catch(e){console.error("connect failed",e),t({event:"fail",reason:"connect failed"})}}try{window.window.MQTTClient=new window.parent.Paho.Client(e.config.wsbroker,e.config.wsport,e.id);var s=-1;window.MQTTClient.onConnectionLost=function(e){t({event:"fail",reason:"connection lost error code "+parseInt(e.errorCode)}),-1===s&&(s=setInterval(function(){return i()},2e3))},window.MQTTClient.onMessageArrived=function(e){try{!function(e){var n="";try{n=e.payloadString}catch(e){}t({event:"data",destinationName:e.destinationName,payloadString:n,payloadBytes:e.payloadBytes||null})}(e)}catch(e){e&&console.error(e)}},i()}catch(e){console.error("IFRAME error"),console.error(e)}},onunload:function(){void 0!==window.MQTTClient&&window.MQTTClient.disconnect()}}}}])},"object"==s(t)&&"object"==s(e)?e.exports=i():(o=[],void 0===(r="function"===typeof(n=i)?n.apply(t,o):n)||(e.exports=r))}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"./node_modules/debug/src/browser.js":function(e,t,n){(function(o){var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!==typeof o&&"env"in o&&(e=o.env.DEBUG),e}(t=e.exports=n("./node_modules/debug/src/debug.js")).log=function(){return"object"===("undefined"===typeof console?"undefined":r(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var o="color: "+this.color;e.splice(1,0,o,"color: inherit");var r=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(i=++r)}),e.splice(i,0,o)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!==typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n("./node_modules/node-libs-browser/node_modules/process/browser.js"))},"./node_modules/debug/src/debug.js":function(e,t,n){function o(e){var n;function o(){if(o.enabled){var e=o,r=+new Date,i=r-(n||r);e.diff=i,e.prev=n,e.curr=r,n=r;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!==typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,o){if("%%"===n)return n;u++;var r=t.formatters[o];if("function"===typeof r){var i=s[u];n=r.call(e,i),s.splice(u,1),u--}return n}),t.formatArgs.call(e,s),(o.log||t.log||console.log.bind(console)).apply(e,s)}}return o.namespace=e,o.enabled=t.enabled(e),o.useColors=t.useColors(),o.color=function(e){var n,o=0;for(n in e)o=(o<<5)-o+e.charCodeAt(n),o|=0;return t.colors[Math.abs(o)%t.colors.length]}(e),o.destroy=r,"function"===typeof t.init&&t.init(o),t.instances.push(o),o}function r(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=o.debug=o.default=o).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var o=("string"===typeof e?e:"").split(/[\s,]+/),r=o.length;for(n=0;n<r;n++)o[n]&&("-"===(e=o[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,o;for(n=0,o=t.skips.length;n<o;n++)if(t.skips[n].test(e))return!1;for(n=0,o=t.names.length;n<o;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("./node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"./node_modules/global/document.js":function(e,t,n){(function(t){var o,r="undefined"!==typeof t?t:"undefined"!==typeof window?window:{},i=n(1);"undefined"!==typeof document?o=document:(o=r["__GLOBAL_DOCUMENT_CACHE@4"])||(o=r["__GLOBAL_DOCUMENT_CACHE@4"]=i),e.exports=o}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/lodash/_Symbol.js":function(e,t,n){var o=n("./node_modules/lodash/_root.js").Symbol;e.exports=o},"./node_modules/lodash/_apply.js":function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},"./node_modules/lodash/_arrayLikeKeys.js":function(e,t,n){var o=n("./node_modules/lodash/_baseTimes.js"),r=n("./node_modules/lodash/isArguments.js"),i=n("./node_modules/lodash/isArray.js"),s=n("./node_modules/lodash/isBuffer.js"),a=n("./node_modules/lodash/_isIndex.js"),u=n("./node_modules/lodash/isTypedArray.js"),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),d=!n&&r(e),l=!n&&!d&&s(e),f=!n&&!d&&!l&&u(e),h=n||d||l||f,p=h?o(e.length,String):[],m=p.length;for(var v in e)!t&&!c.call(e,v)||h&&("length"==v||l&&("offset"==v||"parent"==v)||f&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||a(v,m))||p.push(v);return p}},"./node_modules/lodash/_baseGetTag.js":function(e,t,n){var o=n("./node_modules/lodash/_Symbol.js"),r=n("./node_modules/lodash/_getRawTag.js"),i=n("./node_modules/lodash/_objectToString.js"),s="[object Null]",a="[object Undefined]",u=o?o.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?a:s:u&&u in Object(e)?r(e):i(e)}},"./node_modules/lodash/_baseIsArguments.js":function(e,t,n){var o=n("./node_modules/lodash/_baseGetTag.js"),r=n("./node_modules/lodash/isObjectLike.js"),i="[object Arguments]";e.exports=function(e){return r(e)&&o(e)==i}},"./node_modules/lodash/_baseIsNative.js":function(e,t,n){var o=n("./node_modules/lodash/isFunction.js"),r=n("./node_modules/lodash/_isMasked.js"),i=n("./node_modules/lodash/isObject.js"),s=n("./node_modules/lodash/_toSource.js"),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,d=u.toString,l=c.hasOwnProperty,f=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||r(e))&&(o(e)?f:a).test(s(e))}},"./node_modules/lodash/_baseIsTypedArray.js":function(e,t,n){var o=n("./node_modules/lodash/_baseGetTag.js"),r=n("./node_modules/lodash/isLength.js"),i=n("./node_modules/lodash/isObjectLike.js"),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&r(e.length)&&!!s[o(e)]}},"./node_modules/lodash/_baseKeysIn.js":function(e,t,n){var o=n("./node_modules/lodash/isObject.js"),r=n("./node_modules/lodash/_isPrototype.js"),i=n("./node_modules/lodash/_nativeKeysIn.js"),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!o(e))return i(e);var t=r(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},"./node_modules/lodash/_baseRest.js":function(e,t,n){var o=n("./node_modules/lodash/identity.js"),r=n("./node_modules/lodash/_overRest.js"),i=n("./node_modules/lodash/_setToString.js");e.exports=function(e,t){return i(r(e,t,o),e+"")}},"./node_modules/lodash/_baseSetToString.js":function(e,t,n){var o=n("./node_modules/lodash/constant.js"),r=n("./node_modules/lodash/_defineProperty.js"),i=n("./node_modules/lodash/identity.js"),s=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:o(t),writable:!0})}:i;e.exports=s},"./node_modules/lodash/_baseTimes.js":function(e,t){e.exports=function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}},"./node_modules/lodash/_baseUnary.js":function(e,t){e.exports=function(e){return function(t){return e(t)}}},"./node_modules/lodash/_coreJsData.js":function(e,t,n){var o=n("./node_modules/lodash/_root.js")["__core-js_shared__"];e.exports=o},"./node_modules/lodash/_defineProperty.js":function(e,t,n){var o=n("./node_modules/lodash/_getNative.js"),r=function(){try{var e=o(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=r},"./node_modules/lodash/_freeGlobal.js":function(e,t,n){(function(t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="object"==("undefined"===typeof t?"undefined":n(t))&&t&&t.Object===Object&&t;e.exports=o}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/lodash/_getNative.js":function(e,t,n){var o=n("./node_modules/lodash/_baseIsNative.js"),r=n("./node_modules/lodash/_getValue.js");e.exports=function(e,t){var n=r(e,t);return o(n)?n:void 0}},"./node_modules/lodash/_getRawTag.js":function(e,t,n){var o=n("./node_modules/lodash/_Symbol.js"),r=Object.prototype,i=r.hasOwnProperty,s=r.toString,a=o?o.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var o=!0}catch(e){}var r=s.call(e);return o&&(t?e[a]=n:delete e[a]),r}},"./node_modules/lodash/_getValue.js":function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},"./node_modules/lodash/_isIndex.js":function(e,t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=9007199254740991,r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var i="undefined"===typeof e?"undefined":n(e);return!!(t=null==t?o:t)&&("number"==i||"symbol"!=i&&r.test(e))&&e>-1&&e%1==0&&e<t}},"./node_modules/lodash/_isIterateeCall.js":function(e,t,n){var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("./node_modules/lodash/eq.js"),i=n("./node_modules/lodash/isArrayLike.js"),s=n("./node_modules/lodash/_isIndex.js"),a=n("./node_modules/lodash/isObject.js");e.exports=function(e,t,n){if(!a(n))return!1;var u="undefined"===typeof t?"undefined":o(t);return!!("number"==u?i(n)&&s(t,n.length):"string"==u&&t in n)&&r(n[t],e)}},"./node_modules/lodash/_isMasked.js":function(e,t,n){var o,r=n("./node_modules/lodash/_coreJsData.js"),i=(o=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+o:"";e.exports=function(e){return!!i&&i in e}},"./node_modules/lodash/_isPrototype.js":function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},"./node_modules/lodash/_nativeKeysIn.js":function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},"./node_modules/lodash/_nodeUtil.js":function(e,t,n){(function(e){var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("./node_modules/lodash/_freeGlobal.js"),i="object"==o(t)&&t&&!t.nodeType&&t,s=i&&"object"==o(e)&&e&&!e.nodeType&&e,a=s&&s.exports===i&&r.process,u=function(){try{var e=s&&s.require&&s.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=u}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"./node_modules/lodash/_objectToString.js":function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},"./node_modules/lodash/_overRest.js":function(e,t,n){var o=n("./node_modules/lodash/_apply.js"),r=Math.max;e.exports=function(e,t,n){return t=r(void 0===t?e.length-1:t,0),function(){for(var i=arguments,s=-1,a=r(i.length-t,0),u=Array(a);++s<a;)u[s]=i[t+s];s=-1;for(var c=Array(t+1);++s<t;)c[s]=i[s];return c[t]=n(u),o(e,this,c)}}},"./node_modules/lodash/_root.js":function(e,t,n){var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("./node_modules/lodash/_freeGlobal.js"),i="object"==("undefined"===typeof self?"undefined":o(self))&&self&&self.Object===Object&&self,s=r||i||Function("return this")();e.exports=s},"./node_modules/lodash/_setToString.js":function(e,t,n){var o=n("./node_modules/lodash/_baseSetToString.js"),r=n("./node_modules/lodash/_shortOut.js")(o);e.exports=r},"./node_modules/lodash/_shortOut.js":function(e,t){var n=800,o=16,r=Date.now;e.exports=function(e){var t=0,i=0;return function(){var s=r(),a=o-(s-i);if(i=s,a>0){if(++t>=n)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},"./node_modules/lodash/_toSource.js":function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"./node_modules/lodash/constant.js":function(e,t){e.exports=function(e){return function(){return e}}},"./node_modules/lodash/defaults.js":function(e,t,n){var o=n("./node_modules/lodash/_baseRest.js"),r=n("./node_modules/lodash/eq.js"),i=n("./node_modules/lodash/_isIterateeCall.js"),s=n("./node_modules/lodash/keysIn.js"),a=Object.prototype,u=a.hasOwnProperty,c=o(function(e,t){e=Object(e);var n=-1,o=t.length,c=o>2?t[2]:void 0;for(c&&i(t[0],t[1],c)&&(o=1);++n<o;)for(var d=t[n],l=s(d),f=-1,h=l.length;++f<h;){var p=l[f],m=e[p];(void 0===m||r(m,a[p])&&!u.call(e,p))&&(e[p]=d[p])}return e});e.exports=c},"./node_modules/lodash/eq.js":function(e,t){e.exports=function(e,t){return e===t||e!==e&&t!==t}},"./node_modules/lodash/identity.js":function(e,t){e.exports=function(e){return e}},"./node_modules/lodash/isArguments.js":function(e,t,n){var o=n("./node_modules/lodash/_baseIsArguments.js"),r=n("./node_modules/lodash/isObjectLike.js"),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,u=o(function(){return arguments}())?o:function(e){return r(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},"./node_modules/lodash/isArray.js":function(e,t){var n=Array.isArray;e.exports=n},"./node_modules/lodash/isArrayLike.js":function(e,t,n){var o=n("./node_modules/lodash/isFunction.js"),r=n("./node_modules/lodash/isLength.js");e.exports=function(e){return null!=e&&r(e.length)&&!o(e)}},"./node_modules/lodash/isBuffer.js":function(e,t,n){(function(e){var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("./node_modules/lodash/_root.js"),i=n("./node_modules/lodash/stubFalse.js"),s="object"==o(t)&&t&&!t.nodeType&&t,a=s&&"object"==o(e)&&e&&!e.nodeType&&e,u=a&&a.exports===s?r.Buffer:void 0,c=(u?u.isBuffer:void 0)||i;e.exports=c}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"./node_modules/lodash/isFunction.js":function(e,t,n){var o=n("./node_modules/lodash/_baseGetTag.js"),r=n("./node_modules/lodash/isObject.js"),i="[object AsyncFunction]",s="[object Function]",a="[object GeneratorFunction]",u="[object Proxy]";e.exports=function(e){if(!r(e))return!1;var t=o(e);return t==s||t==a||t==i||t==u}},"./node_modules/lodash/isLength.js":function(e,t){var n=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}},"./node_modules/lodash/isObject.js":function(e,t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){var t="undefined"===typeof e?"undefined":n(e);return null!=e&&("object"==t||"function"==t)}},"./node_modules/lodash/isObjectLike.js":function(e,t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return null!=e&&"object"==("undefined"===typeof e?"undefined":n(e))}},"./node_modules/lodash/isTypedArray.js":function(e,t,n){var o=n("./node_modules/lodash/_baseIsTypedArray.js"),r=n("./node_modules/lodash/_baseUnary.js"),i=n("./node_modules/lodash/_nodeUtil.js"),s=i&&i.isTypedArray,a=s?r(s):o;e.exports=a},"./node_modules/lodash/keysIn.js":function(e,t,n){var o=n("./node_modules/lodash/_arrayLikeKeys.js"),r=n("./node_modules/lodash/_baseKeysIn.js"),i=n("./node_modules/lodash/isArrayLike.js");e.exports=function(e){return i(e)?o(e,!0):r(e)}},"./node_modules/lodash/noop.js":function(e,t){e.exports=function(){}},"./node_modules/lodash/stubFalse.js":function(e,t){e.exports=function(){return!1}},"./node_modules/ms/index.js":function(e,t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=1e3,r=60*o,i=60*r,s=24*i,a=365.25*s;function u(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var c,d="undefined"===typeof e?"undefined":n(e);if("string"===d&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*a;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*i;case"minutes":case"minute":case"mins":case"min":case"m":return n*r;case"seconds":case"second":case"secs":case"sec":case"s":return n*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===d&&!1===isNaN(e))return t.long?u(c=e,s,"day")||u(c,i,"hour")||u(c,r,"minute")||u(c,o,"second")||c+" ms":function(e){if(e>=s)return Math.round(e/s)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=o)return Math.round(e/o)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"./node_modules/node-libs-browser/node_modules/process/browser.js":function(e,t){var n,o,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(e){n=i}try{o="function"===typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var u,c=[],d=!1,l=-1;function f(){d&&u&&(d=!1,u.length?c=u.concat(c):l=-1,c.length&&h())}function h(){if(!d){var e=a(f);d=!0;for(var t=c.length;t;){for(u=c,c=[];++l<t;)u&&u[l].run();l=-1,t=c.length}u=null,d=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||d||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"./node_modules/paho-client/src/paho-mqtt.js":function(e,t,n){(function(e,o){var r,i,s,a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};s=function(){return function(e){var t,n=e.localStorage||(t={},{setItem:function(e,n){t[e]=n},getItem:function(e){return t[e]},removeItem:function(e){delete t[e]}}),o={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},r=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n)){var o="Unknown property, "+n+". Valid properties are:";for(var r in t)t.hasOwnProperty(r)&&(o=o+" "+r);throw new Error(o)}if(a(e[n])!==t[n])throw new Error(c(s.INVALID_TYPE,[a(e[n]),n]))}},i=function(e,t){return function(){return e.apply(t,arguments)}},s={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},u={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},c=function(e,t){var n=e.text;if(t)for(var o,r,i=0;i<t.length;i++)if(o="{"+i+"}",(r=n.indexOf(o))>0){var s=n.substring(0,r),a=n.substring(r+o.length);n=s+t[i]+a}return n},d=[0,6,77,81,73,115,100,112,3],l=[0,4,77,81,84,84,4],f=function(e,t){for(var n in this.type=e,t)t.hasOwnProperty(n)&&(this[n]=t[n])};function h(e,t){var n,r=t,i=e[t],s=i>>4,a=i&=15;t+=1;var u=0,c=1;do{if(t==e.length)return[null,r];u+=(127&(n=e[t++]))*c,c*=128}while(0!==(128&n));var d=t+u;if(d>e.length)return[null,r];var l=new f(s);switch(s){case o.CONNACK:1&e[t++]&&(l.sessionPresent=!0),l.returnCode=e[t++];break;case o.PUBLISH:var h=a>>1&3,p=v(e,t),m=b(e,t+=2,p);t+=p,h>0&&(l.messageIdentifier=v(e,t),t+=2);var y=new S(e.subarray(t,d));1==(1&a)&&(y.retained=!0),8==(8&a)&&(y.duplicate=!0),y.qos=h,y.destinationName=m,l.payloadMessage=y;break;case o.PUBACK:case o.PUBREC:case o.PUBREL:case o.PUBCOMP:case o.UNSUBACK:l.messageIdentifier=v(e,t);break;case o.SUBACK:l.messageIdentifier=v(e,t),t+=2,l.returnCode=e.subarray(t,d)}return[l,d]}function p(e,t,n){return t[n++]=e>>8,t[n++]=e%256,n}function m(e,t,n,o){return g(e,n,o=p(t,n,o)),o+t}function v(e,t){return 256*e[t]+e[t+1]}function y(e){for(var t=0,n=0;n<e.length;n++){var o=e.charCodeAt(n);o>2047?(55296<=o&&o<=56319&&(n++,t++),t+=3):o>127?t+=2:t++}return t}function g(e,t,n){for(var o=n,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(55296<=i&&i<=56319){var a=e.charCodeAt(++r);if(isNaN(a))throw new Error(c(s.MALFORMED_UNICODE,[i,a]));i=a-56320+(i-55296<<10)+65536}i<=127?t[o++]=i:i<=2047?(t[o++]=i>>6&31|192,t[o++]=63&i|128):i<=65535?(t[o++]=i>>12&15|224,t[o++]=i>>6&63|128,t[o++]=63&i|128):(t[o++]=i>>18&7|240,t[o++]=i>>12&63|128,t[o++]=i>>6&63|128,t[o++]=63&i|128)}return t}function b(e,t,n){for(var o,r="",i=t;i<t+n;){var a=e[i++];if(a<128)o=a;else{var u=e[i++]-128;if(u<0)throw new Error(c(s.MALFORMED_UTF,[a.toString(16),u.toString(16),""]));if(a<224)o=64*(a-192)+u;else{var d=e[i++]-128;if(d<0)throw new Error(c(s.MALFORMED_UTF,[a.toString(16),u.toString(16),d.toString(16)]));if(a<240)o=4096*(a-224)+64*u+d;else{var l=e[i++]-128;if(l<0)throw new Error(c(s.MALFORMED_UTF,[a.toString(16),u.toString(16),d.toString(16),l.toString(16)]));if(!(a<248))throw new Error(c(s.MALFORMED_UTF,[a.toString(16),u.toString(16),d.toString(16),l.toString(16)]));o=262144*(a-240)+4096*u+64*d+l}}}o>65535&&(o-=65536,r+=String.fromCharCode(55296+(o>>10)),o=56320+(1023&o)),r+=String.fromCharCode(o)}return r}f.prototype.encode=function(){var e,t=(15&this.type)<<4,n=0,r=[],i=0;switch(void 0!==this.messageIdentifier&&(n+=2),this.type){case o.CONNECT:switch(this.mqttVersion){case 3:n+=d.length+3;break;case 4:n+=l.length+3}n+=y(this.clientId)+2,void 0!==this.willMessage&&(n+=y(this.willMessage.destinationName)+2,(e=this.willMessage.payloadBytes)instanceof Uint8Array||(e=new Uint8Array(a)),n+=e.byteLength+2),void 0!==this.userName&&(n+=y(this.userName)+2),void 0!==this.password&&(n+=y(this.password)+2);break;case o.SUBSCRIBE:t|=2;for(var s=0;s<this.topics.length;s++)r[s]=y(this.topics[s]),n+=r[s]+2;n+=this.requestedQos.length;break;case o.UNSUBSCRIBE:t|=2;for(s=0;s<this.topics.length;s++)r[s]=y(this.topics[s]),n+=r[s]+2;break;case o.PUBREL:t|=2;break;case o.PUBLISH:this.payloadMessage.duplicate&&(t|=8),t=t|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(t|=1),n+=(i=y(this.payloadMessage.destinationName))+2;var a=this.payloadMessage.payloadBytes;n+=a.byteLength,a instanceof ArrayBuffer?a=new Uint8Array(a):a instanceof Uint8Array||(a=new Uint8Array(a.buffer));break;case o.DISCONNECT:}var u=function(e){var t=new Array(1),n=0;do{var o=e%128;(e>>=7)>0&&(o|=128),t[n++]=o}while(e>0&&n<4);return t}(n),c=u.length+1,f=new ArrayBuffer(n+c),h=new Uint8Array(f);if(h[0]=t,h.set(u,1),this.type==o.PUBLISH)c=m(this.payloadMessage.destinationName,i,h,c);else if(this.type==o.CONNECT){switch(this.mqttVersion){case 3:h.set(d,c),c+=d.length;break;case 4:h.set(l,c),c+=l.length}var v=0;this.cleanSession&&(v=2),void 0!==this.willMessage&&(v|=4,v|=this.willMessage.qos<<3,this.willMessage.retained&&(v|=32)),void 0!==this.userName&&(v|=128),void 0!==this.password&&(v|=64),h[c++]=v,c=p(this.keepAliveInterval,h,c)}switch(void 0!==this.messageIdentifier&&(c=p(this.messageIdentifier,h,c)),this.type){case o.CONNECT:c=m(this.clientId,y(this.clientId),h,c),void 0!==this.willMessage&&(c=m(this.willMessage.destinationName,y(this.willMessage.destinationName),h,c),c=p(e.byteLength,h,c),h.set(e,c),c+=e.byteLength),void 0!==this.userName&&(c=m(this.userName,y(this.userName),h,c)),void 0!==this.password&&(c=m(this.password,y(this.password),h,c));break;case o.PUBLISH:h.set(a,c);break;case o.SUBSCRIBE:for(s=0;s<this.topics.length;s++)c=m(this.topics[s],r[s],h,c),h[c++]=this.requestedQos[s];break;case o.UNSUBSCRIBE:for(s=0;s<this.topics.length;s++)c=m(this.topics[s],r[s],h,c)}return f};var _=function(e,t){this._client=e,this._keepAliveInterval=1e3*t,this.isReset=!1;var n=new f(o.PINGREQ).encode(),r=function(e){return function(){return i.apply(e)}},i=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(n),this.timeout=setTimeout(r(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(s.PING_TIMEOUT.code,c(s.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(r(this),this._keepAliveInterval))},this.cancel=function(){clearTimeout(this.timeout)}},w=function(e,t,n,o){t||(t=30);this.timeout=setTimeout(function(e,t,n){return function(){return e.apply(t,n)}}(n,e,o),1e3*t),this.cancel=function(){clearTimeout(this.timeout)}},E=function(t,o,r,i,a){if(!("WebSocket"in e&&null!==e.WebSocket))throw new Error(c(s.UNSUPPORTED,["WebSocket"]));if(!("ArrayBuffer"in e&&null!==e.ArrayBuffer))throw new Error(c(s.UNSUPPORTED,["ArrayBuffer"]));for(var u in this._trace("Paho.Client",t,o,r,i,a),this.host=o,this.port=r,this.path=i,this.uri=t,this.clientId=a,this._wsuri=null,this._localKey=o+":"+r+("/mqtt"!=i?":"+i:"")+":"+a+":",this._msg_queue=[],this._buffered_msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0,n)0!==u.indexOf("Sent:"+this._localKey)&&0!==u.indexOf("Received:"+this._localKey)||this.restore(u)};E.prototype.host=null,E.prototype.port=null,E.prototype.path=null,E.prototype.uri=null,E.prototype.clientId=null,E.prototype.socket=null,E.prototype.connected=!1,E.prototype.maxMessageIdentifier=65536,E.prototype.connectOptions=null,E.prototype.hostIndex=null,E.prototype.onConnected=null,E.prototype.onConnectionLost=null,E.prototype.onMessageDelivered=null,E.prototype.onMessageArrived=null,E.prototype.traceFunction=null,E.prototype._msg_queue=null,E.prototype._buffered_msg_queue=null,E.prototype._connectTimeout=null,E.prototype.sendPinger=null,E.prototype.receivePinger=null,E.prototype._reconnectInterval=1,E.prototype._reconnecting=!1,E.prototype._reconnectTimeout=null,E.prototype.disconnectedPublishing=!1,E.prototype.disconnectedBufferSize=5e3,E.prototype.receiveBuffer=null,E.prototype._traceBuffer=null,E.prototype._MAX_TRACE_ENTRIES=100,E.prototype.connect=function(e){var t=this._traceMask(e,"password");if(this._trace("Client.connect",t,this.socket,this.connected),this.connected)throw new Error(c(s.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(c(s.INVALID_STATE,["already connected"]));this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),this.connectOptions=e,this._reconnectInterval=1,this._reconnecting=!1,e.uris?(this.hostIndex=0,this._doConnect(e.uris[0])):this._doConnect(this.uri)},E.prototype.subscribe=function(e,t){if(this._trace("Client.subscribe",e,t),!this.connected)throw new Error(c(s.INVALID_STATE,["not connected"]));var n=new f(o.SUBSCRIBE);n.topics=e.constructor===Array?e:[e],void 0===t.qos&&(t.qos=0),n.requestedQos=[];for(var r=0;r<n.topics.length;r++)n.requestedQos[r]=t.qos;t.onSuccess&&(n.onSuccess=function(e){t.onSuccess({invocationContext:t.invocationContext,grantedQos:e})}),t.onFailure&&(n.onFailure=function(e){t.onFailure({invocationContext:t.invocationContext,errorCode:e,errorMessage:c(e)})}),t.timeout&&(n.timeOut=new w(this,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:s.SUBSCRIBE_TIMEOUT.code,errorMessage:c(s.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},E.prototype.unsubscribe=function(e,t){if(this._trace("Client.unsubscribe",e,t),!this.connected)throw new Error(c(s.INVALID_STATE,["not connected"]));var n=new f(o.UNSUBSCRIBE);n.topics=e.constructor===Array?e:[e],t.onSuccess&&(n.callback=function(){t.onSuccess({invocationContext:t.invocationContext})}),t.timeout&&(n.timeOut=new w(this,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:s.UNSUBSCRIBE_TIMEOUT.code,errorMessage:c(s.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},E.prototype.send=function(e){this._trace("Client.send",e);var t=new f(o.PUBLISH);if(t.payloadMessage=e,this.connected)e.qos>0?this._requires_ack(t):this.onMessageDelivered&&(this._notify_msg_sent[t]=this.onMessageDelivered(t.payloadMessage)),this._schedule_message(t);else{if(!this._reconnecting||!this.disconnectedPublishing)throw new Error(c(s.INVALID_STATE,["not connected"]));if(Object.keys(this._sentMessages).length+this._buffered_msg_queue.length>this.disconnectedBufferSize)throw new Error(c(s.BUFFER_FULL,[this.disconnectedBufferSize]));e.qos>0?this._requires_ack(t):(t.sequence=++this._sequence,this._buffered_msg_queue.unshift(t))}},E.prototype.disconnect=function(){if(this._trace("Client.disconnect"),this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),!this.socket)throw new Error(c(s.INVALID_STATE,["not connecting or connected"]));var e=new f(o.DISCONNECT);this._notify_msg_sent[e]=i(this._disconnected,this),this._schedule_message(e)},E.prototype.getTraceLog=function(){if(null!==this._traceBuffer){for(var e in this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length),this._sentMessages)this._trace("_sentMessages ",e,this._sentMessages[e]);for(var e in this._receivedMessages)this._trace("_receivedMessages ",e,this._receivedMessages[e]);return this._traceBuffer}},E.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"@VERSION@-@BUILDLEVEL@")},E.prototype.stopTrace=function(){delete this._traceBuffer},E.prototype._doConnect=function(e){if(this.connectOptions.useSSL){var t=e.split(":");t[0]="wss",e=t.join(":")}this._wsuri=e,this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(e,["mqttv3.1"]):this.socket=new WebSocket(e,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=i(this._on_socket_open,this),this.socket.onmessage=i(this._on_socket_message,this),this.socket.onerror=i(this._on_socket_error,this),this.socket.onclose=i(this._on_socket_close,this),this.sendPinger=new _(this,this.connectOptions.keepAliveInterval),this.receivePinger=new _(this,this.connectOptions.keepAliveInterval),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._connectTimeout=new w(this,this.connectOptions.timeout,this._disconnected,[s.CONNECT_TIMEOUT.code,c(s.CONNECT_TIMEOUT)])},E.prototype._schedule_message=function(e){this._msg_queue.unshift(e),this.connected&&this._process_queue()},E.prototype.store=function(e,t){var r={type:t.type,messageIdentifier:t.messageIdentifier,version:1};switch(t.type){case o.PUBLISH:t.pubRecReceived&&(r.pubRecReceived=!0),r.payloadMessage={};for(var i="",a=t.payloadMessage.payloadBytes,u=0;u<a.length;u++)a[u]<=15?i=i+"0"+a[u].toString(16):i+=a[u].toString(16);r.payloadMessage.payloadHex=i,r.payloadMessage.qos=t.payloadMessage.qos,r.payloadMessage.destinationName=t.payloadMessage.destinationName,t.payloadMessage.duplicate&&(r.payloadMessage.duplicate=!0),t.payloadMessage.retained&&(r.payloadMessage.retained=!0),0===e.indexOf("Sent:")&&(void 0===t.sequence&&(t.sequence=++this._sequence),r.sequence=t.sequence);break;default:throw Error(c(s.INVALID_STORED_DATA,[e+this._localKey+t.messageIdentifier,r]))}n.setItem(e+this._localKey+t.messageIdentifier,JSON.stringify(r))},E.prototype.restore=function(e){var t=n.getItem(e),r=JSON.parse(t),i=new f(r.type,r);switch(r.type){case o.PUBLISH:for(var a=r.payloadMessage.payloadHex,u=new ArrayBuffer(a.length/2),d=new Uint8Array(u),l=0;a.length>=2;){var h=parseInt(a.substring(0,2),16);a=a.substring(2,a.length),d[l++]=h}var p=new S(d);p.qos=r.payloadMessage.qos,p.destinationName=r.payloadMessage.destinationName,r.payloadMessage.duplicate&&(p.duplicate=!0),r.payloadMessage.retained&&(p.retained=!0),i.payloadMessage=p;break;default:throw Error(c(s.INVALID_STORED_DATA,[e,t]))}0===e.indexOf("Sent:"+this._localKey)?(i.payloadMessage.duplicate=!0,this._sentMessages[i.messageIdentifier]=i):0===e.indexOf("Received:"+this._localKey)&&(this._receivedMessages[i.messageIdentifier]=i)},E.prototype._process_queue=function(){for(var e=null;e=this._msg_queue.pop();)this._socket_send(e),this._notify_msg_sent[e]&&(this._notify_msg_sent[e](),delete this._notify_msg_sent[e])},E.prototype._requires_ack=function(e){var t=Object.keys(this._sentMessages).length;if(t>this.maxMessageIdentifier)throw Error("Too many messages:"+t);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;e.messageIdentifier=this._message_identifier,this._sentMessages[e.messageIdentifier]=e,e.type===o.PUBLISH&&this.store("Sent:",e),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},E.prototype._on_socket_open=function(){var e=new f(o.CONNECT,this.connectOptions);e.clientId=this.clientId,this._socket_send(e)},E.prototype._on_socket_message=function(e){this._trace("Client._on_socket_message",e.data);for(var t=this._deframeMessages(e.data),n=0;n<t.length;n+=1)this._handleMessage(t[n])},E.prototype._deframeMessages=function(e){var t=new Uint8Array(e),n=[];if(this.receiveBuffer){var o=new Uint8Array(this.receiveBuffer.length+t.length);o.set(this.receiveBuffer),o.set(t,this.receiveBuffer.length),t=o,delete this.receiveBuffer}try{for(var r=0;r<t.length;){var i=h(t,r),a=i[0];if(r=i[1],null===a)break;n.push(a)}r<t.length&&(this.receiveBuffer=t.subarray(r))}catch(e){var u="undefined"==e.hasOwnProperty("stack")?e.stack.toString():"No Error Stack Available";return void this._disconnected(s.INTERNAL_ERROR.code,c(s.INTERNAL_ERROR,[e.message,u]))}return n},E.prototype._handleMessage=function(e){this._trace("Client._handleMessage",e);try{switch(e.type){case o.CONNACK:if(this._connectTimeout.cancel(),this._reconnectTimeout&&this._reconnectTimeout.cancel(),this.connectOptions.cleanSession){for(var t in this._sentMessages){var r=this._sentMessages[t];n.removeItem("Sent:"+this._localKey+r.messageIdentifier)}for(var t in this._sentMessages={},this._receivedMessages){var i=this._receivedMessages[t];n.removeItem("Received:"+this._localKey+i.messageIdentifier)}this._receivedMessages={}}if(0!==e.returnCode){this._disconnected(s.CONNACK_RETURNCODE.code,c(s.CONNACK_RETURNCODE,[e.returnCode,u[e.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);var a=[];for(var d in this._sentMessages)this._sentMessages.hasOwnProperty(d)&&a.push(this._sentMessages[d]);if(this._buffered_msg_queue.length>0)for(var l=null;l=this._buffered_msg_queue.pop();)a.push(l),this.onMessageDelivered&&(this._notify_msg_sent[l]=this.onMessageDelivered(l.payloadMessage));for(var h=0,p=(a=a.sort(function(e,t){return e.sequence-t.sequence})).length;h<p;h++){if((r=a[h]).type==o.PUBLISH&&r.pubRecReceived){var m=new f(o.PUBREL,{messageIdentifier:r.messageIdentifier});this._schedule_message(m)}else this._schedule_message(r)}this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});var v=!1;this._reconnecting&&(v=!0,this._reconnectInterval=1,this._reconnecting=!1),this._connected(v,this._wsuri),this._process_queue();break;case o.PUBLISH:this._receivePublish(e);break;case o.PUBACK:(r=this._sentMessages[e.messageIdentifier])&&(delete this._sentMessages[e.messageIdentifier],n.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(r.payloadMessage));break;case o.PUBREC:if(r=this._sentMessages[e.messageIdentifier]){r.pubRecReceived=!0;m=new f(o.PUBREL,{messageIdentifier:e.messageIdentifier});this.store("Sent:",r),this._schedule_message(m)}break;case o.PUBREL:i=this._receivedMessages[e.messageIdentifier];n.removeItem("Received:"+this._localKey+e.messageIdentifier),i&&(this._receiveMessage(i),delete this._receivedMessages[e.messageIdentifier]);var y=new f(o.PUBCOMP,{messageIdentifier:e.messageIdentifier});this._schedule_message(y);break;case o.PUBCOMP:r=this._sentMessages[e.messageIdentifier];delete this._sentMessages[e.messageIdentifier],n.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(r.payloadMessage);break;case o.SUBACK:(r=this._sentMessages[e.messageIdentifier])&&(r.timeOut&&r.timeOut.cancel(),128===e.returnCode[0]?r.onFailure&&r.onFailure(e.returnCode):r.onSuccess&&r.onSuccess(e.returnCode),delete this._sentMessages[e.messageIdentifier]);break;case o.UNSUBACK:(r=this._sentMessages[e.messageIdentifier])&&(r.timeOut&&r.timeOut.cancel(),r.callback&&r.callback(),delete this._sentMessages[e.messageIdentifier]);break;case o.PINGRESP:this.sendPinger.reset();break;case o.DISCONNECT:this._disconnected(s.INVALID_MQTT_MESSAGE_TYPE.code,c(s.INVALID_MQTT_MESSAGE_TYPE,[e.type]));break;default:this._disconnected(s.INVALID_MQTT_MESSAGE_TYPE.code,c(s.INVALID_MQTT_MESSAGE_TYPE,[e.type]))}}catch(e){var g="undefined"==e.hasOwnProperty("stack")?e.stack.toString():"No Error Stack Available";return void this._disconnected(s.INTERNAL_ERROR.code,c(s.INTERNAL_ERROR,[e.message,g]))}},E.prototype._on_socket_error=function(e){this._reconnecting||this._disconnected(s.SOCKET_ERROR.code,c(s.SOCKET_ERROR,[e.data]))},E.prototype._on_socket_close=function(){this._reconnecting||this._disconnected(s.SOCKET_CLOSE.code,c(s.SOCKET_CLOSE))},E.prototype._socket_send=function(e){if(1==e.type){var t=this._traceMask(e,"password");this._trace("Client._socket_send",t)}else this._trace("Client._socket_send",e);this.socket.send(e.encode()),this.sendPinger.reset()},E.prototype._receivePublish=function(e){switch(e.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(e);break;case 1:var t=new f(o.PUBACK,{messageIdentifier:e.messageIdentifier});this._schedule_message(t),this._receiveMessage(e);break;case 2:this._receivedMessages[e.messageIdentifier]=e,this.store("Received:",e);var n=new f(o.PUBREC,{messageIdentifier:e.messageIdentifier});this._schedule_message(n);break;default:throw Error("Invaild qos="+e.payloadMessage.qos)}},E.prototype._receiveMessage=function(e){this.onMessageArrived&&this.onMessageArrived(e.payloadMessage)},E.prototype._connected=function(e,t){this.onConnected&&this.onConnected(e,t)},E.prototype._reconnect=function(){this._trace("Client._reconnect"),this.connected||(this._reconnecting=!0,this.sendPinger.cancel(),this.receivePinger.cancel(),this._reconnectInterval<128&&(this._reconnectInterval=2*this._reconnectInterval),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))},E.prototype._disconnected=function(e,t){if(this._trace("Client._disconnected",e,t),void 0!==e&&this._reconnecting)this._reconnectTimeout=new w(this,this._reconnectInterval,this._reconnect);else if(this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._msg_queue=[],this._buffered_msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else if(void 0===e&&(e=s.OK.code,t=c(s.OK)),this.connected){if(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:e,errorMessage:t,reconnect:this.connectOptions.reconnect,uri:this._wsuri}),e!==s.OK.code&&this.connectOptions.reconnect)return this._reconnectInterval=1,void this._reconnect()}else 4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:e,errorMessage:t})},E.prototype._trace=function(){if(this.traceFunction){var e=Array.prototype.slice.call(arguments);for(var t in e)"undefined"!==typeof e[t]&&e.splice(t,1,JSON.stringify(e[t]));var n=e.join("");this.traceFunction({severity:"Debug",message:n})}if(null!==this._traceBuffer){t=0;for(var o=arguments.length;t<o;t++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===t?this._traceBuffer.push(arguments[t]):"undefined"===typeof arguments[t]?this._traceBuffer.push(arguments[t]):this._traceBuffer.push("  "+JSON.stringify(arguments[t]))}},E.prototype._traceMask=function(e,t){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=o==t?"******":e[o]);return n};var S=function(e){var t,n;if(!("string"===typeof e||e instanceof ArrayBuffer||ArrayBuffer.isView(e)&&!(e instanceof DataView)))throw c(s.INVALID_ARGUMENT,[e,"newPayload"]);t=e;var o=0,r=!1,i=!1;Object.defineProperties(this,{payloadString:{enumerable:!0,get:function(){return"string"===typeof t?t:b(t,0,t.length)}},payloadBytes:{enumerable:!0,get:function(){if("string"===typeof t){var e=new ArrayBuffer(y(t)),n=new Uint8Array(e);return g(t,n,0),n}return t}},destinationName:{enumerable:!0,get:function(){return n},set:function(e){if("string"!==typeof e)throw new Error(c(s.INVALID_ARGUMENT,[e,"newDestinationName"]));n=e}},qos:{enumerable:!0,get:function(){return o},set:function(e){if(0!==e&&1!==e&&2!==e)throw new Error("Invalid argument:"+e);o=e}},retained:{enumerable:!0,get:function(){return r},set:function(e){if("boolean"!==typeof e)throw new Error(c(s.INVALID_ARGUMENT,[e,"newRetained"]));r=e}},topic:{enumerable:!0,get:function(){return n},set:function(e){n=e}},duplicate:{enumerable:!0,get:function(){return i},set:function(e){i=e}}})};return{Client:function(e,t,n,o){var i;if("string"!==typeof e)throw new Error(c(s.INVALID_TYPE,["undefined"===typeof e?"undefined":a(e),"host"]));if(2==arguments.length){o=t;var u=(i=e).match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!u)throw new Error(c(s.INVALID_ARGUMENT,[e,"host"]));e=u[4]||u[2],t=parseInt(u[7]),n=u[8]}else{if(3==arguments.length&&(o=n,n="/mqtt"),"number"!==typeof t||t<0)throw new Error(c(s.INVALID_TYPE,["undefined"===typeof t?"undefined":a(t),"port"]));if("string"!==typeof n)throw new Error(c(s.INVALID_TYPE,["undefined"===typeof n?"undefined":a(n),"path"]));var d=-1!==e.indexOf(":")&&"["!==e.slice(0,1)&&"]"!==e.slice(-1);i="ws://"+(d?"["+e+"]":e)+":"+t+n}for(var l=0,f=0;f<o.length;f++){var h=o.charCodeAt(f);55296<=h&&h<=56319&&f++,l++}if("string"!==typeof o||l>65535)throw new Error(c(s.INVALID_ARGUMENT,[o,"clientId"]));var p=new E(i,e,t,n,o);Object.defineProperties(this,{host:{get:function(){return e},set:function(){throw new Error(c(s.UNSUPPORTED_OPERATION))}},port:{get:function(){return t},set:function(){throw new Error(c(s.UNSUPPORTED_OPERATION))}},path:{get:function(){return n},set:function(){throw new Error(c(s.UNSUPPORTED_OPERATION))}},uri:{get:function(){return i},set:function(){throw new Error(c(s.UNSUPPORTED_OPERATION))}},clientId:{get:function(){return p.clientId},set:function(){throw new Error(c(s.UNSUPPORTED_OPERATION))}},onConnected:{get:function(){return p.onConnected},set:function(e){if("function"!==typeof e)throw new Error(c(s.INVALID_TYPE,["undefined"===typeof e?"undefined":a(e),"onConnected"]));p.onConnected=e}},disconnectedPublishing:{get:function(){return p.disconnectedPublishing},set:function(e){p.disconnectedPublishing=e}},disconnectedBufferSize:{get:function(){return p.disconnectedBufferSize},set:function(e){p.disconnectedBufferSize=e}},onConnectionLost:{get:function(){return p.onConnectionLost},set:function(e){if("function"!==typeof e)throw new Error(c(s.INVALID_TYPE,["undefined"===typeof e?"undefined":a(e),"onConnectionLost"]));p.onConnectionLost=e}},onMessageDelivered:{get:function(){return p.onMessageDelivered},set:function(e){if("function"!==typeof e)throw new Error(c(s.INVALID_TYPE,["undefined"===typeof e?"undefined":a(e),"onMessageDelivered"]));p.onMessageDelivered=e}},onMessageArrived:{get:function(){return p.onMessageArrived},set:function(e){if("function"!==typeof e)throw new Error(c(s.INVALID_TYPE,["undefined"===typeof e?"undefined":a(e),"onMessageArrived"]));p.onMessageArrived=e}},trace:{get:function(){return p.traceFunction},set:function(e){if("function"!==typeof e)throw new Error(c(s.INVALID_TYPE,["undefined"===typeof e?"undefined":a(e),"onTrace"]));p.traceFunction=e}}}),this.connect=function(e){if(r(e=e||{},{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),void 0===e.keepAliveInterval&&(e.keepAliveInterval=60),e.mqttVersion>4||e.mqttVersion<3)throw new Error(c(s.INVALID_ARGUMENT,[e.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===e.mqttVersion?(e.mqttVersionExplicit=!1,e.mqttVersion=4):e.mqttVersionExplicit=!0,void 0!==e.password&&void 0===e.userName)throw new Error(c(s.INVALID_ARGUMENT,[e.password,"connectOptions.password"]));if(e.willMessage){if(!(e.willMessage instanceof S))throw new Error(c(s.INVALID_TYPE,[e.willMessage,"connectOptions.willMessage"]));if(e.willMessage.stringPayload=null,"undefined"===typeof e.willMessage.destinationName)throw new Error(c(s.INVALID_TYPE,[a(e.willMessage.destinationName),"connectOptions.willMessage.destinationName"]))}if("undefined"===typeof e.cleanSession&&(e.cleanSession=!0),e.hosts){if(!(e.hosts instanceof Array))throw new Error(c(s.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));if(e.hosts.length<1)throw new Error(c(s.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));for(var t=!1,o=0;o<e.hosts.length;o++){if("string"!==typeof e.hosts[o])throw new Error(c(s.INVALID_TYPE,[a(e.hosts[o]),"connectOptions.hosts["+o+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(e.hosts[o])){if(0===o)t=!0;else if(!t)throw new Error(c(s.INVALID_ARGUMENT,[e.hosts[o],"connectOptions.hosts["+o+"]"]))}else if(t)throw new Error(c(s.INVALID_ARGUMENT,[e.hosts[o],"connectOptions.hosts["+o+"]"]))}if(t)e.uris=e.hosts;else{if(!e.ports)throw new Error(c(s.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(!(e.ports instanceof Array))throw new Error(c(s.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(e.hosts.length!==e.ports.length)throw new Error(c(s.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));for(e.uris=[],o=0;o<e.hosts.length;o++){if("number"!==typeof e.ports[o]||e.ports[o]<0)throw new Error(c(s.INVALID_TYPE,[a(e.ports[o]),"connectOptions.ports["+o+"]"]));var u=e.hosts[o],d=e.ports[o],l=-1!==u.indexOf(":");i="ws://"+(l?"["+u+"]":u)+":"+d+n,e.uris.push(i)}}}p.connect(e)},this.subscribe=function(e,t){if("string"!==typeof e&&e.constructor!==Array)throw new Error("Invalid argument:"+e);if(r(t=t||{},{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if("undefined"!==typeof t.qos&&0!==t.qos&&1!==t.qos&&2!==t.qos)throw new Error(c(s.INVALID_ARGUMENT,[t.qos,"subscribeOptions.qos"]));p.subscribe(e,t)},this.unsubscribe=function(e,t){if("string"!==typeof e&&e.constructor!==Array)throw new Error("Invalid argument:"+e);if(r(t=t||{},{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");p.unsubscribe(e,t)},this.send=function(e,t,n,o){var r;if(0===arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof S)&&"string"!==typeof e)throw new Error("Invalid argument:"+("undefined"===typeof e?"undefined":a(e)));if("undefined"===typeof(r=e).destinationName)throw new Error(c(s.INVALID_ARGUMENT,[r.destinationName,"Message.destinationName"]));p.send(r)}else(r=new S(t)).destinationName=e,arguments.length>=3&&(r.qos=n),arguments.length>=4&&(r.retained=o),p.send(r)},this.publish=function(e,t,n,o){var r;if(0===arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof S)&&"string"!==typeof e)throw new Error("Invalid argument:"+("undefined"===typeof e?"undefined":a(e)));if("undefined"===typeof(r=e).destinationName)throw new Error(c(s.INVALID_ARGUMENT,[r.destinationName,"Message.destinationName"]));p.send(r)}else(r=new S(t)).destinationName=e,arguments.length>=3&&(r.qos=n),arguments.length>=4&&(r.retained=o),p.send(r)},this.disconnect=function(){p.disconnect()},this.getTraceLog=function(){return p.getTraceLog()},this.startTrace=function(){p.startTrace()},this.stopTrace=function(){p.stopTrace()},this.isConnected=function(){return p.connected}},Message:S}}("undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},"object"===a(t)&&"object"===a(o)?o.exports=s():void 0===(i="function"===typeof(r=s)?r.call(t,n,t,o):r)||(o.exports=i)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/webpack/buildin/module.js")(e))},"./node_modules/srcdoc-polyfill/srcdoc-polyfill.js":function(e,t,n){var o,r,i;"function"===typeof Symbol&&Symbol.iterator;r=this,i=window.srcDoc,void 0===(o=function(e){!function(e,t){var n,o,r,i=!!("srcdoc"in document.createElement("iframe")),s="Polyfill may not function in the presence of the `sandbox` attribute. Consider using the `force` option.",a=/\ballow-same-origin\b/,u=function(e,t){var n=e.getAttribute("sandbox");"string"!==typeof n||a.test(n)||(t&&t.force?e.removeAttribute("sandbox"):t&&!1===t.force||(r(s),e.setAttribute("data-srcdoc-polyfill",s)))},c={compliant:function(e,t,n){t&&(u(e,n),e.setAttribute("srcdoc",t))},legacy:function(e,t,n){var o;e&&e.getAttribute&&(t?e.setAttribute("srcdoc",t):t=e.getAttribute("srcdoc"),t&&(u(e,n),o="javascript: window.frameElement.getAttribute('srcdoc');",e.contentWindow&&(e.contentWindow.location=o),e.setAttribute("src",o)))}},d=e;if(r=window.console&&window.console.error?function(e){window.console.error("[srcdoc-polyfill] "+e)}:function(){},d.set=c.compliant,d.noConflict=function(){return window.srcDoc=t,d},!i)for(d.set=c.legacy,o=document.getElementsByTagName("iframe"),n=o.length;n--;)d.set(o[n])}(e,i),r.srcDoc=e}.apply(t,[t]))||(e.exports=o)},"./node_modules/uuid/lib/bytesToUuid.js":function(e,t){for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);e.exports=function(e,t){var o=t||0,r=n;return[r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]]].join("")}},"./node_modules/uuid/lib/rng-browser.js":function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var o=new Uint8Array(16);e.exports=function(){return n(o),o}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},"./node_modules/uuid/v4.js":function(e,t,n){var o=n("./node_modules/uuid/lib/rng-browser.js"),r=n("./node_modules/uuid/lib/bytesToUuid.js");e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||o)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[i+a]=s[a];return t||r(s)}},"./node_modules/videojs-errors/dist/videojs-errors.es.js":function(e,t,n){"use strict";n.r(t);var o=n("video.js"),r=n.n(o),i=n("./node_modules/global/document.js"),s=n.n(i),a=r.a.getComponent("Flash"),u=!r.a.browser.IS_IPHONE,c=r.a.registerPlugin||r.a.plugin,d={header:"",code:"",message:"",timeout:45e3,dismiss:u,progressDisabled:!1,errors:{1:{type:"MEDIA_ERR_ABORTED",headline:"The video download was cancelled"},2:{type:"MEDIA_ERR_NETWORK",headline:"The video connection was lost, please confirm you are connected to the internet"},3:{type:"MEDIA_ERR_DECODE",headline:"The video is bad or in a format that cannot be played on your browser"},4:{type:"MEDIA_ERR_SRC_NOT_SUPPORTED",headline:"This video is either unavailable or not supported in this browser"},5:{type:"MEDIA_ERR_ENCRYPTED",headline:"The video you are trying to watch is encrypted and we do not know how to decrypt it"},unknown:{type:"MEDIA_ERR_UNKNOWN",headline:"An unanticipated problem was encountered, check back soon and try again"},"-1":{type:"PLAYER_ERR_NO_SRC",headline:"No video has been loaded"},"-2":{type:"PLAYER_ERR_TIMEOUT",headline:"Could not download the video"},PLAYER_ERR_DOMAIN_RESTRICTED:{headline:"This video is restricted from playing on your current domain"},PLAYER_ERR_IP_RESTRICTED:{headline:"This video is restricted at your current IP address"},PLAYER_ERR_GEO_RESTRICTED:{headline:"This video is restricted from playing in your current geographic region"},FLASHLS_ERR_CROSS_DOMAIN:{headline:"The video could not be loaded: crossdomain access denied."}}},l=function(e){!function e(t,n){var o=void 0,i=void 0,u=void 0,c=[],l=function(e){n.errors=r.a.mergeOptions(n.errors,e),Object.keys(n.errors).forEach(function(e){var t=n.errors[e];t.type||(t.type=e)})};l();var f=function(){t.clearTimeout(i),u&&(u=!1,t.removeClass("vjs-waiting")),i=t.setTimeout(function(){t.error()||t.paused()||t.ended()||(u=!0,t.addClass("vjs-waiting"))},1e3),t.clearTimeout(o),o=t.setTimeout(function(){t.error()||t.paused()||t.ended()||t.error({code:-2,type:"PLAYER_ERR_TIMEOUT"})},n.timeout),t.error()&&-2===t.error().code&&t.error(null)},h=function(){for(var e=void 0;c.length;)e=c.shift(),t.off(e[0],e[1]);t.clearTimeout(o),t.clearTimeout(i)},p=function(e,n){var o=function(){if(!t.error()){var e=t.$(".vjs-tech");if(e&&"application/x-shockwave-flash"===e.type&&!e.vjs_getProperty)return void t.error({code:-2,type:"PLAYER_ERR_TIMEOUT"});if(t.paused())return f();if(t.ended())return f()}n.call(this)};t.on(e,o),c.push([e,o])},m=function(){var e=0;h(),f(),p(["timeupdate","adtimeupdate"],function(){var n=t.currentTime();n!==e&&(e=n,f())}),n.progressDisabled||p("progress",f)},v=function(){t.currentSrc()||t.error({code:-1,type:"PLAYER_ERR_NO_SRC"})},y=function(){var e="",o=t.error(),i=s.a.createElement("div"),u="";if(o){(o=r.a.mergeOptions(o,n.errors[o.code||o.type||0])).message&&(e='<div class="vjs-errors-details">'+t.localize("Technical details")+'\n        : <div class="vjs-errors-message">'+t.localize(o.message)+"</div>\n        </div>"),4===o.code&&a&&!a.isSupported()&&(e+='<span class="vjs-errors-flashmessage">'+t.localize("If you are using an older browser please try upgrading or installing Flash.")+"</span>");var c=t.getChild("errorDisplay");if(i.className="vjs-errors-dialog",i.id="vjs-errors-dialog",u='<div class="vjs-errors-content-container">\n      <h2 class="vjs-errors-headline">'+this.localize(o.headline)+"</h2>\n        <div><b>"+this.localize("Error Code")+"</b>: "+(o.type||o.code)+"</div>\n        "+e+"\n      </div>",c.closeable(!("dismiss"in o)||o.dismiss)){u+='<div class="vjs-errors-ok-button-container">\n          <button class="vjs-errors-ok-button">'+this.localize("OK")+"</button>\n        </div>",i.innerHTML=u,c.fillWith(i),c.contentEl().firstChild.appendChild(c.getChild("closeButton").el());var d=c.el().querySelector(".vjs-errors-ok-button");t.on(d,"click",function(){c.close()})}else i.innerHTML=u,c.fillWith(i);(t.currentWidth()<=600||t.currentHeight()<=250)&&c.addClass("vjs-xs"),c.one("modalclose",function(){return t.error(null)})}},g=function e(){h(),t.removeClass("vjs-errors"),t.off("play",m),t.off("play",v),t.off("dispose",e),t.off(["aderror","error"],y)},b=function(n){g(),e(t,r.a.mergeOptions(d,n))};b.extend=function(e){return l(e)},b.getAll=function(){return r.a.mergeOptions(n.errors)},b.timeout=function(e){if("undefined"===typeof e)return n.timeout;e!==n.timeout&&(n.timeout=e,t.paused()||m())},b.disableProgress=function(e){n.progressDisabled=e,m()},t.on("play",m),t.on("play",v),t.on("dispose",g),t.on(["aderror","error"],y),t.ready(function(){t.addClass("vjs-errors")}),t.paused()||m(),b.VERSION="4.1.3",t.errors=b}(this,r.a.mergeOptions(d,e))};["extend","getAll","disableProgress"].forEach(function(e){l[e]=function(){r.a.log.warn("The errors."+e+"() method is not available until the plugin has been initialized!")}}),l.VERSION="4.1.3",c("errors",l),t.default=l},"./node_modules/webpack/buildin/global.js":function(e,t){var n,o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"===typeof window?"undefined":o(window))&&(n=window)}e.exports=n},"./node_modules/webpack/buildin/module.js":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./package.json":function(e){e.exports={name:"clsp-videojs-plugin",version:"0.14.0-3",description:"Uses clsp (iot) as a video distribution system, video is is received via the clsp client then rendered using the media source extensions. ",main:"dist/clsp-videojs-plugin.js","generator-videojs-plugin":{version:"5.0.0"},scripts:{build:"./scripts/build.sh",serve:"./scripts/serve.sh",lint:"eslint ./ --cache --quiet --ext .js","lint-fix":"eslint ./ --cache --quiet --ext .js --fix",version:"./scripts/version.sh",postversion:"git push && git push --tags"},keywords:["videojs","videojs-plugin"],author:"https://www.skylinenet.net",license:"Apache-2.0",dependencies:{debug:"^3.1.0",lodash:"^4.17.10",moment:"^2.22.2","paho-client":"git+https://github.com/eclipse/paho.mqtt.javascript.git#v1.1.0","videojs-errors":"^4.1.1"},devDependencies:{"babel-core":"^6.26.3","babel-eslint":"^8.2.5","babel-loader":"^7.1.5","babel-plugin-transform-class-properties":"^6.24.1","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-polyfill":"^6.26.0","babel-preset-env":"^1.7.0","css-loader":"^0.28.11",eslint:"^5.0.1","extract-text-webpack-plugin":"^4.0.0-beta.0",jquery:"^3.3.1","node-sass":"^4.9.1","pre-commit":"^1.2.2","sass-loader":"^7.0.3","srcdoc-polyfill":"^1.0.0",standard:"^11.0.1","style-loader":"^0.21.0","uglifyjs-webpack-plugin":"^1.2.7","url-loader":"^1.0.1","video.js":"6.7.1",webpack:"^4.15.1","webpack-serve":"^2.0.2","write-file-webpack-plugin":"^4.3.2"}}},"./src/js/clsp-videojs-plugin.js":function(e,t,n){"use strict";n.r(t);var o=n("./src/js/plugin/MseOverMqttPlugin.js"),r=Object(o.default)();r.register(),t.default=r},"./src/js/iov/Conduit.js":function(e,t,n){"use strict";n.r(t);var o=n("./dist/Router.min.js"),r=n.n(o),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.iov=t,this.clientId=t.config.clientId,this.dispatch={},this.iframe=this.generateIframe(),this.attachIframe(),this.destroyed=!1}return i(e,null,[{key:"factory",value:function(t){return new e(t)}}]),i(e,[{key:"generateIframe",value:function(){var e=document.createElement("iframe"),t='\n      <html>\n        <head>\n          <script type="text/javascript">\n            window.MqttClientId = "'+this.clientId+'";\n            window.iframeCode = '+r.a.toString()+'();\n          <\/script>\n        </head>\n        <body onload="window.iframeCode.clspRouter();" onunload="window.iframeCode.onunload();">\n          <div id="message"></div>\n        </body>\n      </html>\n    ';return e.srcdoc=t,e.width=0,e.height=0,e.setAttribute("style","display:none;"),e.setAttribute("id",this.clientId),e}},{key:"attachIframe",value:function(){var e=this;if(null!==this.iov.config.videoElementParent)this.iov.config.videoElementParent.appendChild(this.iframe);else if(null!==this.iov.videoElement.parentNode)this.iov.videoElement.parentNode.appendChild(this.iframe),this.iov.config.videoElementParent=this.iov.videoElement.parentNode;else var t=setInterval(function(){null!==e.iov.videoElement.parentNode&&(e.iov.videoElement.parentNode.appendChild(e.iframe),e.iov.config.videoElementParent=e.iov.videoElement.parentNode,clearInterval(t))},1e3)}},{key:"command",value:function(e){var t=this;if(null===this.iframe.contentWindow)var n=setInterval(function(){null!==t.iframe.contentWindow&&(t.iframe.contentWindow.postMessage(e,"*"),clearInterval(n))},1e3);else this.iframe.contentWindow.postMessage(e,"*")}},{key:"inboundHandler",value:function(e){var t=this.dispatch[e.destinationName];if("undefined"!==typeof t)try{t(e)}catch(e){console.error(e)}else console.error("No handler for "+e.destinationName)}},{key:"subscribe",value:function(e,t){this.dispatch[e]=t,this.command({method:"subscribe",topic:e})}},{key:"unsubscribe",value:function(e){e in this.dispatch&&delete this.dispatch[e],this.command({method:"unsubscribe",topic:e})}},{key:"publish",value:function(e,t){this.command({method:"publish",topic:e,data:t})}},{key:"transaction",value:function(e,t,n){var o=this;n.resp_topic=this.clientId+"/response/"+parseInt(1e6*Math.random()),this.subscribe(n.resp_topic,function(e){var r=JSON.parse(e.payloadString);t(r),o.unsubscribe(n.resp_topic)}),this.publish(e,n)}},{key:"destroy",value:function(){this.destroyed||(this.destroyed=!0,this.iov.destroy(),this.iov=null,this.clientId=null,this.dispatch=null,this.iframe=null)}}]),e}();t.default=s},"./src/js/iov/IOV.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),i=n("./node_modules/uuid/v4.js"),s=n.n(i),a=n("./node_modules/lodash/defaults.js"),u=n.n(a),c=(n("./node_modules/srcdoc-polyfill/srcdoc-polyfill.js"),n("./src/js/iov/Player.js")),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var f="skyline:clsp:iov",h=function(){function e(t,n,o,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onChangeSource=function(e,t){return a.changeSource(t.url)},this.id=s()(),this.debug=r()(f+":"+this.id+":main"),this.debug("constructor"),this.destroyed=!1,this.onReadyAlreadyCalled=!1,this.playerInstance=n,this.videoElement=this.playerInstance.el(),this.options=u()({},i,{changeSourceMaxWait:9750,statsInterval:3e4,enableMetrics:!0}),this.config={clientId:this.id,wsbroker:o.wsbroker,wsport:o.wsport,useSSL:o.useSSL,streamName:o.streamName,videoElementParent:o.videoElementParent||null},this.statsMsg={byteCount:0,inkbps:0,host:document.location.host,clientId:this.config.clientId},this.mqttConduitCollection=t}return l(e,null,[{key:"generateConfigFromUrl",value:function(e){if(!e)throw new Error("No source was given to be parsed!");var t=document.createElement("a"),n=void 0,o=void 0;if("clsps"===e.substring(0,5).toLowerCase())n=!0,t.href=e.replace("clsps","https"),o=443;else{if("clsp"!==e.substring(0,4).toLowerCase())throw new Error("The given source is not a clsp url, and therefore cannot be parsed.");n=!1,t.href=e.replace("clsp","http"),o=9001}var r=t.pathname.split("/"),i=r[r.length-1],s=t.hostname,a=t.port;return 0===a.length&&(a=o),"@"===s&&(s=window.location.hostname),{wsbroker:s,wsport:parseInt(a),streamName:i,useSSL:n}}},{key:"factory",value:function(t,n){return new e(t,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})}},{key:"fromUrl",value:function(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return e.factory(n,o,d({},r,e.generateConfigFromUrl(t)),i)}}]),l(e,[{key:"initialize",value:function(){return this.conduit=this.mqttConduitCollection.addFromIov(this),this.player=c.default.factory(this,this.playerInstance),this}},{key:"clone",value:function(t,n){this.debug("clone");var o=d({},t,{videoElementParent:this.config.videoElementParent});return e.factory(this.mqttConduitCollection,this.playerInstance,o,n)}},{key:"changeSource",value:function(t){if(this.debug('changeSource on player "'+this.id+'""'),!t)throw new Error("Unable to change source because there is no url!");var n=this.clone(e.generateConfigFromUrl(t),this.options);n.initialize(),n.player.videoElement.style.display="none",setTimeout(function(){n.playerInstance.tech(!0).mqtt.updateIOV(n),n.player.videoElement.style.display="initial"},n.options.changeSourceMaxWait)}},{key:"onReady",value:function(e){var t=this;this.debug("onReady"),null!==this.videoElement.parentNode&&(this.config.videoElementParentId=this.videoElement.parentNode.id);var n=this.playerInstance.children()[0];null!==n.getAttribute("autoplay")&&this.playerInstance.trigger("play",n),this.onReadyAlreadyCalled?console.error("tried to use this player more than once..."):(this.onReadyAlreadyCalled=!0,this.player.on("firstFrameShown",function(){t.playerInstance.loadingSpinner.hide(),n.style.display="none"}),this.player.on("videoReceived",function(){t.playerInstance.trigger("timeupdate")}),this.player.on("videoInfoReceived",function(){t.playerInstance.trigger("timeupdate")}),this.playerInstance.on("changesrc",this.onChangeSource),this.player.play(this.videoElement.firstChild.id,this.config.streamName),this.videoElement.addEventListener("mse-error-event",function(e){t.player.restart()},!1),this._statsTimer=setInterval(function(){t.statsMsg.inkbps=8*t.statsMsg.byteCount/t.options.statsInterval,t.statsMsg.byteCount=0,t.conduit.publish("iov/stats",t.statsMsg),t.debug("iov status",t.statsMsg)},this.options.statsInterval))}},{key:"onFail",value:function(e){this.debug("onFail"),this.debug("network error",e.data.reason),this.playerInstance.trigger("network-error",e.data.reason)}},{key:"onData",value:function(e){this.debug("onData"),this.conduit.inboundHandler(e.data)}},{key:"onMessage",value:function(e){var t=e.data.event;switch(this.debug("onMessage",t),t){case"ready":this.onReady(e);break;case"fail":this.onFail(e);break;case"data":this.onData(e);break;default:console.error("No match for event: "+t)}}},{key:"destroy",value:function(){if(this.debug("destroy"),!this.destroyed){this.destroyed=!0,clearInterval(this._statsTimer),this.conduit.unsubscribe("iov/video/"+this.player.guid+"/live"),this.playerInstance.off("changesrc",this.onChangeSource),this.player.destroy(),this.playerInstance=null,this.player=null,this.mqttConduitCollection.remove(this.id);var e=document.getElementById(this.config.clientId);e.parentNode.removeChild(e),e.srcdoc=""}}}]),e}();t.default=h},"./src/js/iov/Player.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/uuid/v4.js"),r=n.n(o),i=n("./node_modules/lodash/defaults.js"),s=n.n(i),a=n("./src/js/utils/ListenerBaseClass.js"),u=n("./src/js/mse/MediaSourceWrapper.js"),c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function o(r,i){try{var s=t[r](i),a=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(a).then(function(e){o("next",e)},function(e){o("throw",e)});e(a)}("next")})}}var f=function(e){function t(e,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t.DEBUG_NAME));return i.debug("constructor"),i._id=r()(),i.iov=e,i.playerInstance=n,i.eid=i.playerInstance.el().firstChild.id,i.id=i.eid.replace("_html5_api",""),i.initializeVideoElement(),i.options=s()({},o,{segmentIntervalSampleSize:5,driftCorrectionConstant:2,enableMetrics:!0}),i.state="initializing",i.firstFrameShown=!1,i.LogSourceBuffer=!1,i.LogSourceBufferTopic=null,i.latestSegmentReceived=null,i.segmentIntervalAverage=null,i.segmentInterval=null,i.segmentIntervals=[],i.mediaSourceWrapper=null,i.moovBox=null,i.guid=null,i.mimeCodec=null,i}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["default"]),d(t,null,[{key:"factory",value:function(e,n){return new t(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}}]),d(t,[{key:"_onError",value:function(e,t,n){console.error(t),console.error(n)}},{key:"initializeVideoElement",value:function(){var e=this;if(this.videoJsVideoElement=document.getElementById(this.eid),!this.videoJsVideoElement)throw new Error('Unable to find an element in the DOM with id "'+this.eid+'".');var t="clsp-video-"+this._id;this.videoElement=this.videoJsVideoElement.cloneNode(),this.videoElement.setAttribute("id",t),this.videoElement.classList.add("clsp-video"),this.videoElementParent=this.videoJsVideoElement.parentNode,this.on("firstFrameShown",function(){if(null!==e.videoElementParent)try{e.videoElementParent.insertBefore(e.videoElement,e.videoJsVideoElement);for(var n=e.videoElementParent.getElementsByTagName("video"),o=0;o<n.length;o++){var r=n[o],i=r.getAttribute("id");if(i!==e.eid&&i!==t){e.videoElementParent.removeChild(r),r.remove(),r=null,n=null;break}}}catch(e){console.error(e)}})}},{key:"reinitializeMseWrapper",value:function(){var e=l(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.mediaSourceWrapper&&this.mediaSourceWrapper.destroy(),this.mediaSourceWrapper=u.default.factory(this.videoElement),e.prev=2,this.mediaSourceWrapper.registerMimeCodec(this.mimeCodec),e.next=13;break;case 6:throw e.prev=6,e.t0=e.catch(2),this.state="unsupported-mime-codec",t="Unsupported mime codec: "+this.mimeCodec,this.videoPlayer.errors.extend({PLAYER_ERR_IOV:{headline:"Error Playing Stream",message:t}}),this.videoPlayer.error({code:"PLAYER_ERR_IOV"}),new Error(t);case 13:return this.mediaSourceWrapper.on("metric",function(e){var t=e.type,o=e.value;n.trigger("metric",{type:t,value:o})}),this.mediaSourceWrapper.on("sourceOpen",l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.debug("on mediaSource sourceopen"),e.next=3,n.mediaSourceWrapper.initializeSourceBuffer();case 3:n.mediaSourceWrapper.sourceBuffer.on("metric",function(e){var t=e.type,o=e.value;n.trigger("metric",{type:t,value:o})}),n.mediaSourceWrapper.sourceBuffer.on("appendStart",function(e){if(n.silly("On Append Start..."),!0===n.LogSourceBuffer&&null!==n.LogSourceBufferTopic){n.debug("Recording "+parseInt(e.length)+" bytes of data.");var t=new window.Paho.MQTT.Message(e);t.destinationName=n.LogSourceBufferTopic,window.MQTTClient.send(t)}n.iov.statsMsg.byteCount+=e.length}),n.mediaSourceWrapper.sourceBuffer.on("appendFinish",function(e){if(n.silly("On Append Finish..."),n.firstFrameShown||(n.firstFrameShown=!0,n.trigger("firstFrameShown")),n.drift=e.bufferTimeEnd-n.videoElement.currentTime,n.metric("iovPlayer.sourceBuffer.bufferTimeEnd",e.bufferTimeEnd),n.metric("iovPlayer.video.currentTime",n.videoElement.currentTime),n.metric("iovPlayer.video.drift",n.drift),n.drift>n.segmentIntervalAverage/1e3+n.options.driftCorrectionConstant&&(n.metric("iovPlayer.video.driftCorrection",1),n.videoElement.currentTime=e.bufferTimeEnd),!0===n.videoElement.paused){n.debug("Video is paused!");try{var t=n.videoElement.play();"undefined"!==typeof t&&t.catch(function(e){n._onError("videojs.play.promise","Error while trying to play videojs player",e)})}catch(e){n._onError("videojs.play.notPromise","Error while trying to play videojs player",e)}}}),n.mediaSourceWrapper.sourceBuffer.on("appendError",function(){var e=l(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n._onError("sourceBuffer.append","Error while appending to sourceBuffer",t),e.next=3,n.reinitializeMseWrapper();case 3:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}()),n.mediaSourceWrapper.sourceBuffer.on("removeFinish",function(e){n.debug("onRemoveFinish")}),n.mediaSourceWrapper.sourceBuffer.on("removeError",function(e){"DOMException"!==e.constructor.name&&n._onError("sourceBuffer.remove","Error while removing segments from sourceBuffer",e)}),n.mediaSourceWrapper.sourceBuffer.on("streamFrozen",l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.debug("stream appears to be frozen - reinitializing..."),e.next=3,n.reinitializeMseWrapper();case 3:case"end":return e.stop()}},e,n)}))),n.mediaSourceWrapper.sourceBuffer.on("error",function(e){n._onError("mediaSource.sourceBuffer.generic","mediaSource sourceBuffer error",e)}),n.trigger("videoInfoReceived"),n.mediaSourceWrapper.sourceBuffer.appendMoov(n.moovBox);case 13:case"end":return e.stop()}},e,n)}))),this.mediaSourceWrapper.on("sourceEnded",function(){n.debug("on mediaSource sourceended"),n.stop()}),this.mediaSourceWrapper.on("error",function(e){n._onError("mediaSource.generic","mediaSource error",e)}),e.next=19,this.mediaSourceWrapper.initializeMediaSource();case 19:if(this.mediaSourceWrapper.mediaSource&&this.videoElement){e.next=21;break}throw new Error("The video element or mediaSource is not ready!");case 21:this.mediaSourceWrapper.reinitializeVideoElementSrc();case 22:case"end":return e.stop()}},e,this,[[2,6]])}));return function(){return e.apply(this,arguments)}}()},{key:"resyncStream",value:function(){var e=this;this.debug("Trying to resync stream..."),this.iov.conduit.subscribe("iov/video/"+this.guid+"/resync",l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.debug("sync received re-initialize media source buffer"),t.next=3,e.reinitializeMseWrapper();case 3:case"end":return t.stop()}},t,e)})))}},{key:"restart",value:function(){this.debug("restart"),this.stop(),this.play()}},{key:"play",value:function(e){var t=this;this.debug("play"),this.iov.conduit.transaction("iov/video/"+window.btoa(this.iov.config.streamName)+"/request",function(){return t.onIovPlayTransaction.apply(t,arguments)},{clientId:this.iov.config.clientId,resp_topic:this.iov.config.clientId+"'/response/'"+parseInt(1e6*Math.random())})}},{key:"stop",value:function(){this.debug("stop"),this.moovBox=null,void 0!==this.guid&&this.iov.conduit.unsubscribe("iov/video/"+this.guid+"/live"),this.iov.conduit.publish("iov/video/"+this.guid+"/stop",{clientId:this.iov.config.clientId})}},{key:"getSegmentIntervalMetrics",value:function(){var e=this.latestSegmentReceived;if(this.latestSegmentReceived=Date.now(),e&&(this.segmentInterval=this.latestSegmentReceived-e),this.segmentInterval){this.segmentIntervals.length>=this.options.segmentIntervalSampleSize&&this.segmentIntervals.shift(),this.segmentIntervals.push(this.segmentInterval);for(var t=0,n=0;n<this.segmentIntervals.length;n++)t+=this.segmentIntervals[n];this.segmentIntervalAverage=t/this.segmentIntervals.length,this.metric("iovPlayer.video.segmentInterval",this.segmentInterval),this.metric("iovPlayer.video.segmentIntervalAverage",this.segmentIntervalAverage)}}},{key:"onIovPlayTransaction",value:function(e){var t=this,n=e.mimeCodec,o=e.guid;this.debug("onIovPlayTransaction");var r,i=this.iov.config.clientId+"/init-segment/"+parseInt(1e6*Math.random());this.state="waiting-for-first-moov",this.iov.conduit.subscribe(i,(r=l(regeneratorRuntime.mark(function e(r){var s,a,u=r.payloadBytes;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.debug("onIovPlayTransaction "+i+" listener fired"),t.debug('received moov of type "'+("undefined"===typeof u?"undefined":c(u))+'" from server'),s=u,t.state="waiting-for-first-moof",t.iov.conduit.unsubscribe(i),a="iov/video/"+o+"/live",t.iov.conduit.subscribe(a,function(e){t.trigger("videoReceived"),t.getSegmentIntervalMetrics(),t.mediaSourceWrapper.sourceBuffer.append(e.payloadBytes)}),t.guid=o,t.moovBox=s,t.mimeCodec=n,e.next=12,t.reinitializeMseWrapper();case 12:t.resyncStream();case 13:case"end":return e.stop()}},e,t)})),function(e){return r.apply(this,arguments)})),this.iov.conduit.publish("iov/video/"+o+"/play",{initSegmentTopic:i,clientId:this.iov.config.clientId})}},{key:"destroy",value:function(){this.destroyed||(function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(o):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.destroyed=!0,this.stop(),this.iov=null,this.state=null,this.firstFrameShown=null,this.playerInstance=null,this.videoJsVideoElement=null,this.videoElementParent=null,this.events=null,this.metrics=null,this.LogSourceBuffer=null,this.LogSourceBufferTopic=null,this.latestSegmentReceived=null,this.segmentIntervalAverage=null,this.segmentInterval=null,this.segmentIntervals=null,this.moovBox=null,this.guid=null,this.mimeCodec=null,this.mediaSourceWrapper.destroy(),this.mediaSourceWrapper=null,this.videoElement.src="",this.videoElement=null)}}]),t}();f.DEBUG_NAME="skyline:clsp:iov:player",f.EVENT_NAMES=["metric","firstFrameShown","videoReceived","videoInfoReceived"],f.METRIC_TYPES=["iovPlayer.sourceBuffer.bufferTimeEnd","iovPlayer.video.currentTime","iovPlayer.video.drift","iovPlayer.video.driftCorrection","iovPlayer.video.segmentInterval","iovPlayer.video.segmentIntervalAverage"],t.default=f},"./src/js/mse/MediaSourceWrapper.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/lodash/defaults.js"),r=n.n(o),i=n("./node_modules/lodash/noop.js"),s=n.n(i),a=n("./src/js/utils/ListenerBaseClass.js"),u=n("./src/js/mse/SourceBufferWrapper.js"),c=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(o):void 0},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function o(r,i){try{var s=t[r](i),a=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(a).then(function(e){o("next",e)},function(e){o("throw",e)});e(a)}("next")})}}var f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t.DEBUG_NAME));if(o.debug("Constructing..."),!e)throw new Error("videoElement is required to construct an MediaSourceWrapper.");return o.videoElement=e,o.options=r()({},n,{duration:10,enableMetrics:!0}),o.eventListeners={sourceopen:function(){o.mediaSource.duration=o.options.duration,o.trigger("sourceOpen")},sourceended:function(){o.trigger("sourceEnded")},error:function(e){o.trigger("error",e)}},o.destroyed=!1,o.mediaSource=null,o.sourceBuffer=null,o.objectURL=null,o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["default"]),d(t,null,[{key:"isMimeCodecSupported",value:function(e){return window.MediaSource&&window.MediaSource.isTypeSupported(e)}},{key:"factory",value:function(e){return new t(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}}]),d(t,[{key:"initializeMediaSource",value:function(){var e=l(regeneratorRuntime.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.debug("Initializing mediaSource..."),t=r()({},t,{onSourceOpen:s.a,onSourceEnded:s.a,onError:s.a}),this.metric("mediaSource.created",1),e.next=5,this.destroyMediaSource();case 5:this.mediaSource=new window.MediaSource,this.mediaSource.addEventListener("sourceopen",this.eventListeners.sourceopen),this.mediaSource.addEventListener("sourceended",this.eventListeners.sourceended),this.mediaSource.addEventListener("error",this.eventListeners.error);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"registerMimeCodec",value:function(e){if(!t.isMimeCodecSupported(e))throw new Error('Mime codec of "'+e+'" is not supported.');this.mimeCodec=e}},{key:"getVideoElementSrc",value:function(){this.debug("getVideoElementSrc..."),this.mediaSource&&(this.objectURL||(this.metric("mediaSource.objectURL.created",1),this.objectURL=window.URL.createObjectURL(this.mediaSource)),this.videoElement.src=this.objectURL)}},{key:"destroyVideoElementSrc",value:function(){if(this.debug("destroyVideoElementSrc..."),this.mediaSource&&this.objectURL)return this.metric("mediaSource.objectURL.revoked",1),this.objectURL=null,this.sourceBuffer&&this.sourceBuffer.abort(),window.URL.revokeObjectURL(this.videoElement.src)}},{key:"reinitializeVideoElementSrc",value:function(){return this.metric("mediaSource.reinitialized",1),this.destroyVideoElementSrc(),this.getVideoElementSrc()}},{key:"isReady",value:function(){return this.mediaSource&&"open"===this.mediaSource.readyState}},{key:"initializeSourceBuffer",value:function(){var e=l(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mimeCodec){e.next=2;break}throw new Error("You must register a valid mime codec first.");case 2:if(this.isReady()){e.next=4;break}throw new Error("Cannot create the sourceBuffer if the mediaSource is not ready.");case 4:if(!this.sourceBuffer){e.next=7;break}return e.next=7,this.sourceBuffer.destroy();case 7:this.sourceBuffer=u.default.factory(this,t);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"destroyMediaSource",value:function(){var e=l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mediaSource){e.next=2;break}return e.abrupt("return");case 2:if(this.mediaSource.removeEventListener("sourceopen",this.eventListeners.sourceopen),this.mediaSource.removeEventListener("sourceended",this.eventListeners.sourceended),this.mediaSource.removeEventListener("error",this.eventListeners.error),this.isReady()&&this.sourceBuffer.isReady())try{this.mediaSource.endOfStream()}catch(e){this.debug(e),this.metric("mediaSource.endOfStream.error",1)}return this.mediaSource.removeSourceBuffer(this.sourceBuffer.sourceBuffer),this.destroyVideoElementSrc(),e.next=10,this.sourceBuffer.destroy();case 10:this.metric("mediaSource.destroyed",1),this.sourceBuffer=null,this.mediaSource=null;case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.debug("destroySourceBuffer..."),!this.destroyed){e.next=3;break}return e.abrupt("return");case 3:return this.destroyed=!0,this.debug("Destroying mediaSource..."),e.next=7,this.destroyMediaSource();case 7:this.videoElement=null,this.options=null,this.eventListeners=null,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();f.DEBUG_NAME="skyline:clsp:mse:MediaSourceWrapper",f.EVENT_NAMES=["metric","sourceOpen","sourceEnded","error"],f.METRIC_TYPES=["mediaSource.created","mediaSource.destroyed","mediaSource.reinitialized","mediaSource.objectURL.created","mediaSource.objectURL.revoked","mediaSource.endOfStream.error"],t.default=f},"./src/js/mse/SourceBufferWrapper.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/lodash/defaults.js"),r=n.n(o),i=n("./src/js/utils/ListenerBaseClass.js"),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t.DEBUG_NAME));return o.debug("initializeSourceBuffer..."),o.options=r()({},n,{bufferSizeLimit:90+Math.floor(200*Math.random()),bufferTruncateFactor:2,bufferTruncateValue:null,driftThreshold:2e3,enableMetrics:!0,minimumBufferIncrementSize:.5}),o.options.bufferTruncateValue||(o.options.bufferTruncateValue=parseInt(o.options.bufferSizeLimit/o.options.bufferTruncateFactor)),o.mediaSource=e,o.sourceBuffer=o.mediaSource.mediaSource.addSourceBuffer(o.mediaSource.mimeCodec),o.sourceBuffer.mode="sequence",o.metric("sourceBuffer.created",1),o.eventListeners={onUpdateEnd:function(){o.onUpdateEnd()},onAppendStart:function(e){o.trigger("appendStart",e)},onAppendFinish:function(e){o.trigger("appendFinish",e)},onAppendError:function(e){o.trigger("appendError",e)},onRemoveFinish:function(e){o.trigger("removeFinish",e)},onRemoveError:function(e){o.trigger("removeError",e)},onStreamFrozen:function(){o.trigger("streamFrozen")},onError:function(e){o.trigger("error",e)}},o.sourceBuffer.addEventListener("updateend",o.eventListeners.onUpdateEnd),o.sourceBuffer.addEventListener("error",o.eventListeners.onError),o.destroyed=!1,o.segmentQueue=[],o.sequenceNumber=0,o.timeBuffered=null,o.previousTimeEnd=null,o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),s(t,null,[{key:"factory",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw new Error("A mediaSource object is required to create a sourceBuffer.");return new t(e,n)}}]),s(t,[{key:"isReady",value:function(){return this.sourceBuffer&&!1===this.sourceBuffer.updating}},{key:"queueSegment",value:function(e){this.debug("Queueing segment.  The queue now has "+this.segmentQueue.length+" segments."),this.metric("sourceBuffer.queue.added",1),this.segmentQueue.push({timestamp:Date.now(),moof:e})}},{key:"abort",value:function(){this.debug("Aborting current sourceBuffer operation");try{this.metric("sourceBuffer.abort",1),this.sourceBuffer.abort()}catch(e){this.metric("sourceBuffer.abort.error",1),this.eventListeners.onAbortError&&this.eventListeners.onAbortError(e)}}},{key:"processNextInQueue",value:function(){return this.silly("processNextInQueue"),"hidden"===document.visibilityState?(this.debug("Tab not in focus - dropping frame..."),this.metric("sourceBuffer.frameDrop.hiddenTab",1),void this.metric("sourceBuffer.queue.cannotProcessNext",1)):this.mediaSource.isReady()?this.isReady()?void(this.segmentQueue.length>0&&(this.metric("sourceBuffer.queue.shift",1),this.metric("sourceBuffer.queue.canProcessNext",1),this._append(this.segmentQueue.shift()))):(this.debug("The sourceBuffer is busy"),this.metric("sourceBuffer.queue.sourceBufferNotReady",1),void this.metric("sourceBuffer.queue.cannotProcessNext",1)):(this.debug("The mediaSource is not ready"),this.metric("sourceBuffer.queue.mediaSourceNotReady",1),void this.metric("sourceBuffer.queue.cannotProcessNext",1))}},{key:"formatMoof",value:function(e){return e[20]=(4278190080&this.sequenceNumber)>>24,e[21]=(16711680&this.sequenceNumber)>>16,e[22]=(65280&this.sequenceNumber)>>8,e[23]=255&this.sequenceNumber,e}},{key:"appendMoov",value:function(e){this.debug("appendMoov"),this.metric("sourceBuffer.lastMoovSize",e.length),this.eventListeners.onAppendStart&&(this.debug("appending moov..."),this.queueSegment(e),this.processNextInQueue())}},{key:"append",value:function(e){this.silly("Append"),this.metric("sourceBuffer.lastMoofSize",e.length),this.eventListeners.onAppendStart&&(this.eventListeners.onAppendStart(e),this.metric("sourceBuffer.queue.append",1),this.queueSegment(this.formatMoof(e)),this.sequenceNumber++,this.processNextInQueue())}},{key:"_append",value:function(e){var t=e.timestamp,n=e.moof;this.silly("Appending to the sourceBuffer...");try{var o=Date.now()-t;if(o>this.options.driftThreshold)return this.debug("Estimated drift of "+o+" is above the "+this.options.driftThreshold+" threshold.  Flushing queue..."),this.metric("queue.removed",this.segmentQueue.length+1),void(this.segmentQueue=[]);this.debug("Appending to the buffer with an estimated drift of "+o),this.metric("sourceBuffer.append",1),this.sourceBuffer.appendBuffer(n)}catch(e){this.metric("sourceBuffer.append.error",1),this.eventListeners.onAppendError(e,n)}}},{key:"getBufferTimes",value:function(){var e=this.timeBuffered,t=this.sourceBuffer.buffered.start(0),n=this.sourceBuffer.buffered.end(0);return{previousBufferSize:e,currentBufferSize:n-t,bufferTimeStart:t,bufferTimeEnd:n}}},{key:"trimBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.metric("sourceBuffer.lastKnownBufferSize",this.timeBuffered);try{e||(e=this.getBufferTimes()),(t||this.timeBuffered>this.options.bufferSizeLimit&&this.isReady())&&(this.debug("Removing old stuff from sourceBuffer..."),this.metric("sourceBuffer.trim",this.options.bufferTruncateValue),this.sourceBuffer.remove(e.bufferTimeStart,e.bufferTimeStart+this.options.bufferTruncateValue))}catch(e){this.metric("sourceBuffer.trim.error",1),this.eventListeners.onRemoveError(e)}}},{key:"onRemoveFinish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getBufferTimes();this.debug("On remove finish..."),this.metric("sourceBuffer.updateEnd.removeEvent",1),this.eventListeners.onRemoveFinish(e)}},{key:"onAppendFinish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getBufferTimes();if(this.silly("On append finish..."),this.metric("sourceBuffer.updateEnd.appendEvent",1),this.previousTimeEnd&&e.bufferTimeEnd<=this.previousTimeEnd)return this.metric("sourceBuffer.updateEnd.bufferFrozen",1),void this.eventListeners.onStreamFrozen();e.previousBufferSize&&e.currentBufferSize-e.previousBufferSize<this.options.minimumBufferIncrementSize&&this.metric("sourceBuffer.insufficientBufferAppends",1),this.previousTimeEnd=e.bufferTimeEnd,this.eventListeners.onAppendFinish(e),this.trimBuffer(e)}},{key:"onUpdateEnd",value:function(){this.silly("onUpdateEnd"),this.metric("sourceBuffer.updateEnd",1);try{if(this.sourceBuffer.buffered.length<=0)return this.metric("sourceBuffer.updateEnd.bufferLength.empty",1),void this.debug("After updating, the sourceBuffer has no length!")}catch(e){return this.metric("sourceBuffer.updateEnd.bufferLength.error",1),void this.debug("The mediaSource was removed while an update operation was occurring.")}var e=this.getBufferTimes();this.timeBuffered=e.currentBufferSize,null!==e.previousBufferSize&&e.previousBufferSize>this.timeBuffered?this.onRemoveFinish(e):this.onAppendFinish(e),this.processNextInQueue()}},{key:"destroy",value:function(){var e=this;return new Promise(function(n,o){if(e.destroyed)return n();e.destroyed=!0,e.abort(),e.sourceBuffer.removeEventListener("updateend",e.eventListeners.onUpdateEnd),e.sourceBuffer.removeEventListener("error",e.eventListeners.onError),e.sourceBuffer.addEventListener("updateend",function(){n()}),e.trimBuffer(void 0,!0),e.timeBuffered=null,e.previousTimeEnd=null,e.segmentQueue=null,e.options=null,e.eventListeners=null,e.mediaSource=null,e.sourceBuffer=null,function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(o):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",e).call(e)})}}]),t}();a.DEBUG_NAME="skyline:clsp:mse:SourceBufferWrapper",a.EVENT_NAMES=["metric","appendStart","appendFinish","removeFinish","appendError","removeError","streamFrozen","error"],a.METRIC_TYPES=["sourceBuffer.created","sourceBuffer.destroyed","sourceBuffer.queue.added","sourceBuffer.queue.removed","sourceBuffer.append","sourceBuffer.append.error","sourceBuffer.frameDrop.hiddenTab","sourceBuffer.queue.mediaSourceNotReady","sourceBuffer.queue.sourceBufferNotReady","sourceBuffer.queue.shift","sourceBuffer.queue.append","sourceBuffer.lastKnownBufferSize","sourceBuffer.insufficientBufferAppends","sourceBuffer.trim","sourceBuffer.trim.error","sourceBuffer.updateEnd","sourceBuffer.updateEnd.bufferLength.empty","sourceBuffer.updateEnd.bufferLength.error","sourceBuffer.updateEnd.removeEvent","sourceBuffer.updateEnd.appendEvent","sourceBuffer.updateEnd.bufferFrozen","sourceBuffer.abort","sourceBuffer.abort.error","sourceBuffer.lastMoofSize"],t.default=a},"./src/js/plugin/MqttConduitCollection.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),i=n("./src/js/iov/Conduit.js"),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var a=void 0,u=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onMessage=function(e){t.silly("window on message");var n=e.data.clientId;t.exists(n)?t.getById(n).iov.onMessage(e):"fail"===!e.data.event&&console.error('No conduit with id "'+n+'" exists!')},this.debug=r()("skyline:clsp:plugin:MqttConduitCollection"),this.silly=r()("skyline:silly:clsp:plugin:MqttConduitCollection"),this.debug("constructing..."),this._conduits={},window.addEventListener("message",this.onMessage)}return s(e,null,[{key:"factory",value:function(){return a||(a=new e),a}}]),s(e,[{key:"set",value:function(e,t){return this.debug("setting...",e,t),this._conduits[e]=t,t}},{key:"getById",value:function(e){return this.silly("getting...",e),this._conduits[e]}},{key:"exists",value:function(e){return this.silly("exists?",e),this._conduits.hasOwnProperty(e)}},{key:"remove",value:function(e){delete this._conduits[e]}},{key:"addFromIov",value:function(e){this.debug("adding from iov...",e);var t=this.exists(e.config.clientId)?this.getById(e.config.clientId):i.default.factory(e);return this.set(e.config.clientId,t)}},{key:"destroy",value:function(){this.debug("destroying..."),this._conduits=null,window.removeEventListener("message",this.onMessage)}}]),e}();t.default=u},"./src/js/plugin/MqttHandler.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),i=n("video.js"),s=n.n(i),a=n("./src/js/iov/IOV.js"),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var c=s.a.getComponent("Component"),d=function(e){function t(e,n,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i.mqtt));return s.debug=r()("skyline:clsp:plugin:MqttHandler"),s.debug("constructor"),s.tech_=n,s.source_=e,s.iov=null,s.conduits=o,s}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c),u(t,[{key:"createIOV",value:function(e){this.debug("createIOV"),this.updateIOV(a.default.fromUrl(this.source_.src,this.conduits,e)),this.iov.initialize()}},{key:"updateIOV",value:function(e){if(this.debug("updateIOV"),this.iov){if(this.iov.id===e.id)return;this.iov.destroy()}this.iov=e}},{key:"destroy",value:function(){this.debug("destroying..."),this.debug=null,this.tech_=null,this.source_=null,this.iov=null,this.conduits=null}}]),t}();t.default=d},"./src/js/plugin/MqttSourceHandler.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),i=n("video.js"),s=n.n(i),a=n("./src/js/plugin/MqttHandler.js"),u=n("./src/js/utils/utils.js"),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var d=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.debug=r()("skyline:clsp:plugin:MqttSourceHandler"),this.debug("constructor"),this.name=u.default.name,this.VERSION=u.default.version,this.mode=t,this.conduits=n,this.defaultLocalOptions={mqtt:{mode:this.mode}}}return c(e,null,[{key:"factory",value:function(t,n){return new e(t,n)}}]),c(e,[{key:"canHandleSource",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.debug("canHandleSource"),e.src?e.src.startsWith("clsp")?u.default.supported()?this.canPlayType(e.type):(this.debug("Browser not supported. Chrome 52+ is required."),!1):(console.error("srcObj.src is not clsp protocol"),!1):(console.error("srcObj doesn't contain src"),this.debug(e),!1)}},{key:"handleSource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.debug("handleSource");var o=s.a.mergeOptions(s.a.options,n,this.defaultLocalOptions);return t.mqtt=new a.default(e,t,this.conduits,o),t.mqtt}},{key:"canPlayType",value:function(e){return this.debug("canPlayType"),u.default.isSupportedMimeType(e)?(this.debug("found supported mime type"),"maybe"):(this.debug("mime type not supported"),"")}},{key:"destroy",value:function(){this.debug("destroying..."),this.debug=null,this.name=null,this.VERSION=null,this.mode=null,this.conduits=null,this.defaultLocalOptions=null}}]),e}();t.default=d},"./src/js/plugin/MseOverMqttPlugin.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),i=n("video.js"),s=n.n(i),a=(n("./node_modules/videojs-errors/dist/videojs-errors.es.js"),n("./src/styles/clsp-videojs-plugin.scss"),n("./node_modules/paho-client/src/paho-mqtt.js")),u=n.n(a),c=n("./src/js/utils/utils.js"),d=n("./src/js/plugin/MqttSourceHandler.js"),l=n("./src/js/plugin/MqttConduitCollection.js"),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var p=s.a.getPlugin("plugin");t.default=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=e=function(e){function t(e,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i,a=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return a.debug=r()("skyline:clsp:plugin:MseOverMqttPlugin"),a.debug("constructing..."),o=s.a.mergeOptions(n,o),e.addClass("vjs-clsp"),o.customClass&&e.addClass(o.customClass),e.errors({errors:{PLAYER_ERR_NOT_COMPAT:{headline:"This browser is unsupported.",message:"Chrome 52+ is required."}},timeout:12e4}),c.default.supported()?(e._currentTime=0,e.currentTime=function(){return e._currentTime++},e.on("firstplay",function(t){a.debug("on player firstplay");var n=e.tech(!0).mqtt;if(!n)throw new Error("VideoJS Player "+e.id()+" does not have mqtt tech!");n.createIOV(e),n.iov.player.on("metric",function(e){a.trigger("metric",{metric:e})})}),a):(i=e.error({code:"PLAYER_ERR_NOT_COMPAT",dismiss:!1}),h(a,i))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p),f(t,null,[{key:"register",value:function(){if(s.a.getPlugin(c.default.name))throw new Error("You can only register the clsp plugin once, and it has already been registered.");window.Paho=u.a;var e=d.default.factory("html5",t.conduits);return s.a.getTech("Html5").registerSourceHandler(e,0),s.a.registerPlugin(c.default.name,t),t}}]),f(t,[{key:"destroy",value:function(){this.debug("destroying..."),this.debug=null}}]),t}(),e.VERSION=c.default.version,e.utils=c.default,e.conduits=l.default.factory(),t}},"./src/js/utils/ListenerBaseClass.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.debug=r()(t),this.silly=r()("silly:"+t),this.metrics={},this.events={};for(var n=0;n<this.constructor.EVENT_NAMES.length;n++)this.events[this.constructor.EVENT_NAMES[n]]=[]}return i(e,[{key:"on",value:function(e,t){if(this.debug("Registering Listener for "+e+" event..."),!this.constructor.EVENT_NAMES.includes(e))throw new Error('"'+e+'" is not a valid event."');this.events[e].push(t)}},{key:"trigger",value:function(e,t){if("metric"===e?this.silly("Triggering "+e+" event..."):this.debug("Triggering "+e+" event..."),!this.constructor.EVENT_NAMES.includes(e))throw new Error('"'+e+'" is not a valid event."');for(var n=0;n<this.events[e].length;n++)this.events[e][n](t,this)}},{key:"metric",value:function(e,t){if(this.options&&this.options.enableMetrics&&this.constructor.METRIC_TYPES.includes(e)){switch(e){case"iovPlayer.sourceBuffer.bufferTimeEnd":case"iovPlayer.video.currentTime":case"iovPlayer.video.drift":case"iovPlayer.video.segmentInterval":case"iovPlayer.video.segmentIntervalAverage":case"sourceBuffer.lastKnownBufferSize":case"sourceBuffer.lastMoofSize":this.metrics[e]=t;break;default:this.metrics.hasOwnProperty(e)||(this.metrics[e]=0),this.metrics[e]+=t}this.trigger("metric",{type:e,value:this.metrics[e]})}}},{key:"destroy",value:function(){this.metrics=null,this.events=null,this.debug=null,this.silly=null}}]),e}();s.DEBUG_NAME="skyline:clsp:utils:ListenerBaseClass",s.EVENT_NAMES=[],s.METRIC_TYPES=[],t.default=s},"./src/js/utils/utils.js":function(e,t,n){"use strict";n.r(t);var o=n("./package.json"),r=52,i="video/mp4; codecs='avc1.42E01E'";t.default={version:o.version,name:"clsp",supported:function(){if(!Boolean(window.chrome)||!Boolean(window.chrome.webstore))return!1;if(window.MediaSource=window.MediaSource||window.WebKitMediaSource,!window.MediaSource)return console.error("Media Source Extensions not supported in your browser: Claris Live Streaming will not work!"),!1;try{return parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10)>=r}catch(e){return console.error(e),!1}},isSupportedMimeType:function(e){return e===i}}},"./src/styles/clsp-videojs-plugin.scss":function(e,t){},0:function(e,t,n){e.exports=n("./src/js/clsp-videojs-plugin.js")},1:function(e,t){},"video.js":function(e,t){e.exports=videojs}});